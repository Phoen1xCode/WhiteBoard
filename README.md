# WhiteBoard

è¿™æ˜¯ä¸€ä¸ªå¯åˆ†äº«ã€å¯å®æ—¶å±•ç¤ºçš„**åœ¨çº¿å›¢é˜Ÿåä½œç™½æ¿**ï¼Œä»¿ç…§ excalidraw çš„ç•Œé¢å’ŒåŠŸèƒ½å¼€å‘ã€‚

## é¡¹ç›®ç‰¹ç‚¹

- å¤šç§ç»˜å›¾å·¥å…·ï¼šè‡ªç”±çº¿æ¡ã€çŸ©å½¢ã€åœ†å½¢ã€ç›´çº¿ç­‰
- å®æ—¶åä½œï¼šå¤šäººåŒæ—¶ç¼–è¾‘ï¼Œå®æ—¶åŒæ­¥
- ä¸€é”®åˆ†äº«ï¼šç”Ÿæˆåˆ†äº«é“¾æ¥ï¼Œæ”¯æŒå¤šäººæŸ¥çœ‹
- Monorepo æ¶æ„ï¼šå‰åç«¯ä»£ç ç»Ÿä¸€ç®¡ç†

## ğŸ¯ åŠŸèƒ½åˆ—è¡¨

### å·²å®Œæˆ âœ…

- [x] åŸºç¡€æ¶æ„æ­å»ºï¼ˆMonorepo + Yarn Workspacesï¼‰
- [x] è‡ªç”±çº¿æ¡ç»˜åˆ¶ï¼ˆFreehandï¼‰
- [x] çŸ©å½¢ã€åœ†å½¢ã€ç›´çº¿ç»˜åˆ¶å·¥å…·
- [x] å®æ—¶æ“ä½œåŒæ­¥ï¼ˆSocket.IOï¼‰
- [x] ç™½æ¿æ•°æ®æŒä¹…åŒ–ï¼ˆPostgreSQLï¼‰
- [x] åŸºç¡€ REST APIï¼ˆåˆ›å»º/è·å–ç™½æ¿ï¼‰
- [x] é¢œè‰²é€‰æ‹©å™¨ã€çº¿æ¡ç²—ç»†è°ƒæ•´
- [x] å®çº¿/è™šçº¿æ ·å¼åˆ‡æ¢
- [x] å…ƒç´ é€‰ä¸­ã€ç¼–è¾‘ã€åˆ é™¤
- [x] å±æ€§é¢æ¿ï¼ˆPropertyPanelï¼‰
- [x] å…ƒç´ æ‹–åŠ¨å’Œå˜æ¢ï¼ˆTransformerï¼‰
- [x] é”®ç›˜å¿«æ·é”®æ”¯æŒï¼ˆå·¥å…·åˆ‡æ¢ã€åˆ é™¤ã€Undo/Redoï¼‰
- [x] Undo/Redo åŠŸèƒ½
- [x] ç”¨æˆ·å…‰æ ‡å®æ—¶æ˜¾ç¤º
- [x] æ©¡çš®æ“¦å·¥å…·
- [x] åˆ†äº«é“¾æ¥å¤åˆ¶åŠŸèƒ½
- [x] è¿æ¥çŠ¶æ€æ˜¾ç¤º
- [x] é¦–é¡µç™½æ¿åˆ—è¡¨ç®¡ç†

### è®¡åˆ’ä¸­ ğŸ“‹

- [ ] UI/UX ä¼˜åŒ–ï¼ˆå‚è€ƒ Excalidraw è®¾è®¡é£æ ¼ï¼‰
- [ ] æ›´å¤šå›¾å½¢ç±»å‹æ‰©å±•
- [ ] ç™½æ¿å¯¼å‡ºï¼ˆPNG/SVGï¼‰
- [ ] Docker éƒ¨ç½²é…ç½®

## æŠ€æœ¯æ ˆ

### å‰ç«¯

- æ¡†æ¶ï¼šReact + TypeScript + Vite
- ç»˜å›¾å¼•æ“ï¼šKonva.js + react-konva
- çŠ¶æ€ç®¡ç†ï¼šZustand + Immer
- æ ¡éªŒåè®®ï¼šzod
- å¿«æ·é”®ä¸æ‰‹åŠ¿ï¼šreact-hotkeys-hook + Pointer Events
- UI: Tailwind CSS + Lucide Icon

### åç«¯

- æ¡†æ¶ï¼šNode.js + Koa
- å®æ—¶åä½œï¼šSocket.IO
- æ•°æ®åº“ï¼šPostgreSQL + Prisma

### å·¥ç¨‹/è¿ç»´

- åŒ…ç®¡ç†å™¨ï¼šyarn
- ä»£ç è´¨é‡ï¼šESLint + Prettier
- æµ‹è¯•ï¼šVitestï¼ˆè®¡åˆ’ä¸­ï¼‰+ Playwrightï¼ˆè®¡åˆ’ä¸­ï¼‰
- éƒ¨ç½²ï¼šDocker éƒ¨ç½²

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js >= 18
- Yarn >= 1.22
- PostgreSQL >= 14

### å®‰è£…æ­¥éª¤

1. **å…‹éš†ä»“åº“**

```bash
git clone https://github.com/Phoen1xCode/WhiteBoard.git
cd WhiteBoard
```

2. **å®‰è£…ä¾èµ–**

```bash
yarn install
```

3. **é…ç½®æ•°æ®åº“**

åˆ›å»º PostgreSQL æ•°æ®åº“ï¼Œç„¶åé…ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º .env æ–‡ä»¶
DATABASE_URL="postgresql://user:password@localhost:5432/whiteboard"
```

4. **è¿è¡Œæ•°æ®åº“è¿ç§»**

```bash
cd apps/server
yarn prisma:generate
yarn prisma:migrate
cd ../..
```

5. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**

æ‰“å¼€ä¸¤ä¸ªç»ˆç«¯ï¼š

```bash
# ç»ˆç«¯ 1: å¯åŠ¨åç«¯ (é»˜è®¤ç«¯å£ 3000)
cd apps/server
yarn dev

# ç»ˆç«¯ 2: å¯åŠ¨å‰ç«¯ (é»˜è®¤ç«¯å£ 5173)
cd apps/web
yarn dev
```

6. **è®¿é—®åº”ç”¨**

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:5173

## é¡¹ç›®ç»“æ„

```
WhiteBoard/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web/                 # å‰ç«¯åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ components/  # React ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ store/       # Zustand çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/       # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â”‚   â””â”€â”€ lib/         # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â””â”€â”€ server/              # åç«¯åº”ç”¨
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ controllers/ # æ§åˆ¶å™¨
â”‚       â”‚   â”œâ”€â”€ services/    # ä¸šåŠ¡é€»è¾‘
â”‚       â”‚   â”œâ”€â”€ routes/      # è·¯ç”±å®šä¹‰
â”‚       â”‚   â””â”€â”€ ws/          # WebSocket å¤„ç†
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ shared/              # å…±äº«ç±»å‹å’Œå·¥å…·
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ types/       # TypeScript ç±»å‹å®šä¹‰
â”‚       â”‚   â””â”€â”€ schemas/     # Zod éªŒè¯æ¨¡å¼
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma        # æ•°æ®åº“æ¨¡å‹
â”‚
â”œâ”€â”€ ROADMAP.md               # å¼€å‘è·¯çº¿å›¾
â”œâ”€â”€ CLAUDE.md                # AI åŠ©æ‰‹æŒ‡å—
â””â”€â”€ package.json             # æ ¹é…ç½®
```

## æ¶æ„è®¾è®¡

### å®æ—¶åä½œåŸç†

æœ¬é¡¹ç›®é‡‡ç”¨ **Operation-based Synchronization** å®ç°å®æ—¶åä½œï¼š

1. **åˆå§‹åŒæ­¥**ï¼šå®¢æˆ·ç«¯è¿æ¥æ—¶ä»æ•°æ®åº“åŠ è½½ç™½æ¿å¿«ç…§
2. **æ“ä½œæµå¼åŒæ­¥**ï¼šæ‰€æœ‰ç¼–è¾‘æ“ä½œé€šè¿‡ Socket.IO å®æ—¶å¹¿æ’­
3. **ä¹è§‚æ›´æ–°**ï¼šæœ¬åœ°æ“ä½œç«‹å³åº”ç”¨ï¼Œæ— éœ€ç­‰å¾…æœåŠ¡å™¨å“åº”

### æ“ä½œç±»å‹

æ‰€æœ‰ç™½æ¿ä¿®æ”¹é€šè¿‡ç»Ÿä¸€çš„ `WhiteBoardOperation` ç±»å‹ï¼š

- `add` - æ·»åŠ æ–°å…ƒç´ 
- `update` - ä¿®æ”¹ç°æœ‰å…ƒç´ 
- `delete` - åˆ é™¤å…ƒç´ 
- `clear` - æ¸…ç©ºç”»æ¿

## ğŸ”§ å¼€å‘å‘½ä»¤

```bash
# å®‰è£…ä¾èµ–
yarn install

# å‰ç«¯å¼€å‘
cd apps/web && yarn dev

# åç«¯å¼€å‘
cd apps/server && yarn dev

# ç±»å‹æ£€æŸ¥
cd packages/shared && yarn type-check

# ä»£ç æ£€æŸ¥
yarn lint  # åœ¨å„ä¸ªå­åŒ…ä¸­è¿è¡Œ

# Prisma ç›¸å…³
cd apps/server
yarn prisma:generate   # ç”Ÿæˆ Prisma Client
yarn prisma:migrate    # è¿è¡Œæ•°æ®åº“è¿ç§»
```

## ğŸ³ Docker éƒ¨ç½²

### å‰ç½®è¦æ±‚

- Docker >= 20.10
- Docker Compose >= 2.0

### å¿«é€Ÿéƒ¨ç½²

1. **é…ç½®ç¯å¢ƒå˜é‡**

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶
cp .env.docker.example .env.docker

# ç¼–è¾‘é…ç½®ï¼ˆå¯é€‰ï¼‰
vim .env.docker
```

2. **æ„å»ºå¹¶å¯åŠ¨æœåŠ¡**

```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose --env-file .env.docker up -d --build

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

3. **è®¿é—®åº”ç”¨**

- å‰ç«¯ï¼šhttp://localhost
- åç«¯ APIï¼šhttp://localhost:3000

### Docker æœåŠ¡è¯´æ˜

| æœåŠ¡     | ç«¯å£ | è¯´æ˜                 |
| -------- | ---- | -------------------- |
| web      | 80   | å‰ç«¯ Nginx æœåŠ¡      |
| server   | 4000 | åç«¯ API + WebSocket |
| postgres | 5432 | PostgreSQL æ•°æ®åº“    |


## âŒ¨ï¸ é”®ç›˜å¿«æ·é”®

| å¿«æ·é”®                   | åŠŸèƒ½             |
| ------------------------ | ---------------- |
| `P`                      | åˆ‡æ¢åˆ°ç”»ç¬”å·¥å…·   |
| `R`                      | åˆ‡æ¢åˆ°çŸ©å½¢å·¥å…·   |
| `O`                      | åˆ‡æ¢åˆ°åœ†å½¢å·¥å…·   |
| `L`                      | åˆ‡æ¢åˆ°ç›´çº¿å·¥å…·   |
| `E`                      | åˆ‡æ¢åˆ°æ©¡çš®æ“¦å·¥å…· |
| `Delete` / `Backspace`   | åˆ é™¤é€‰ä¸­å…ƒç´      |
| `Ctrl+Z` / `Cmd+Z`       | æ’¤é”€             |
| `Ctrl+Y` / `Cmd+Shift+Z` | é‡åš             |
| `Escape`                 | å–æ¶ˆé€‰ä¸­         |

## ğŸ‘¥ ä½œè€…

[@Phoen1xCode](https://github.com/Phoen1xCode)
